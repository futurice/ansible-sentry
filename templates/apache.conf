<VirtualHost _default_:80>
    ServerName {{sentry_domain}}
    DocumentRoot /dev/null/

    <Location />
        Options +FollowSymLinks +Includes -Indexes
    </Location>

    ProxyPass / {{sentry_protocol}}://localhost:{{sentry_web_port}}/ retry=5 timeout=30
    ProxyPassReverse / {{sentry_protocol}}://localhost:{{sentry_web_port}}/
    ProxyPreserveHost On

    RequestHeader set X-Proxy-REMOTE-USER %{REMOTE_USER}e
    RequestHeader set REMOTE-USER %{REMOTE_USER}e
    
    {% if sentry_protocol == 'https' %}
    RequestHeader set X-Forwarded-Proto "https" env=HTTPS
    {% endif %}
</VirtualHost>
